---
config:
theme: 'base'
themeVariables:
    primaryColor: '#BB2528'
    primaryTextColor: '#fff'
    primaryBorderColor: '#7C0000'
    lineColor: '#F8B229'
    secondaryColor: '#267826'
    tertiaryColor: '#fff'
---
flowchart LR
    classDef SOURCE stroke:#00f,fill:#0ff,color:black
    classDef TARGET stroke:#0f0,fill:#0fa,color:black
    classDef INTERNAL stroke:#f00,fill:#fa0,color:black

    target:::TARGET
    sample_table:::SOURCE
    transaction_table:::SOURCE

    subgraph sample_table
        sample_table.id[id]
    end

    subgraph target
        target.count[count]
        target.id[id]
        target.total_amount[total_amount]
    end

    subgraph transaction_table
        transaction_table.amount[amount]
        transaction_table.id[id]
        transaction_table.sign[sign]
    end

    sample_table.id -- GROUP_BY --> target.count
    sample_table.id -- COLUMN,GROUP_BY,JOIN --> target.id
    sample_table.id -- GROUP_BY,JOIN --> target.total_amount
    transaction_table.amount -- COLUMN --> target.total_amount
    transaction_table.id -- GROUP_BY --> target.count
    transaction_table.id -- GROUP_BY,JOIN --> target.id
    transaction_table.id -- FILTER,GROUP_BY,JOIN --> target.total_amount
    transaction_table.sign -- COLUMN --> target.total_amount
