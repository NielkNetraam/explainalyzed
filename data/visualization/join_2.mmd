---
config:
theme: 'base'
themeVariables:
    primaryColor: '#BB2528'
    primaryTextColor: '#fff'
    primaryBorderColor: '#7C0000'
    lineColor: '#F8B229'
    secondaryColor: '#267826'
    tertiaryColor: '#fff'
---
flowchart TD
    classDef PROJECT stroke:Blue,fill:LightBlue,color:black
    classDef FILTER stroke:Green,fill:LightGreen,color:black
    classDef UNION stroke:Purple,fill:Violet,color:black
    classDef JOIN stroke:DarkOrange,fill:Orange,color:black
    classDef RELATION stroke:Yellow,fill:Gold,color:black
    classDef AGGREGATE stroke:Brown,fill:Chocolate,color:black

    Project#1["Project: [name#66 AS name_a#89, name#80 AS name_b#90]"]:::PROJECT
    Join#11["Join: Inner, (id#79 = id2#72)"]:::JOIN
    Project#111["Project: [name#66, id2#72]"]:::PROJECT
    Join#1111["Join: Inner, (id#65 = id1#71)"]:::JOIN
    Union#11111["Union"]:::UNION
    Project#111111["Project: [id#65, name#66]"]:::PROJECT
    Filter#1111111["Filter: isnotnull(id#65)"]:::FILTER
    Relation#11111111["sample_table: [id#65,name#66,age#67] parquet"]:::RELATION
    Project#111112["Project: [id#68, name#69]"]:::PROJECT
    Filter#1111121["Filter: isnotnull(id#68)"]:::FILTER
    Relation#11111211["sample_table_2: [id#68,name#69,birth_date#70] parquet"]:::RELATION
    Project#11112["Project: [id1#71, id2#72]"]:::PROJECT
    Filter#111121["Filter: ((isnotnull(rel_type#73) AND (rel_type#73 = friend)) AND (isnotnull(id1#71) AND isnotnull(id2#72)))"]:::FILTER
    Relation#1111211["relation_table: [id1#71,id2#72,rel_type#73] parquet"]:::RELATION
    Union#112["Union"]:::UNION
    Project#1121["Project: [id#79, name#80]"]:::PROJECT
    Filter#11211["Filter: isnotnull(id#79)"]:::FILTER
    Relation#112111["sample_table: [id#79,name#80,age#81] parquet"]:::RELATION
    Project#1122["Project: [id#83, name#84]"]:::PROJECT
    Filter#11221["Filter: isnotnull(id#83)"]:::FILTER
    Relation#112211["sample_table_2: [id#83,name#84,birth_date#85] parquet"]:::RELATION

    Project#1 --> Join#11
        Join#11 --> Project#111
            Project#111 --> Join#1111
                Join#1111 --> Union#11111
                    Union#11111 --> Project#111111
                        Project#111111 --> Filter#1111111
                            Filter#1111111 --> Relation#11111111
                    Union#11111 --> Project#111112
                        Project#111112 --> Filter#1111121
                            Filter#1111121 --> Relation#11111211
                Join#1111 --> Project#11112
                    Project#11112 --> Filter#111121
                        Filter#111121 --> Relation#1111211
        Join#11 --> Union#112
            Union#112 --> Project#1121
                Project#1121 --> Filter#11211
                    Filter#11211 --> Relation#112111
            Union#112 --> Project#1122
                Project#1122 --> Filter#11221
                    Filter#11221 --> Relation#112211
