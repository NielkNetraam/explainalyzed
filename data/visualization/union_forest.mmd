---
config:
theme: 'base'
themeVariables:
    primaryColor: '#BB2528'
    primaryTextColor: '#fff'
    primaryBorderColor: '#7C0000'
    lineColor: '#F8B229'
    secondaryColor: '#267826'
    tertiaryColor: '#fff'
---
flowchart TD
    classDef PROJECT stroke:Blue,fill:LightBlue,color:black
    classDef FILTER stroke:Green,fill:LightGreen,color:black
    classDef UNION stroke:Purple,fill:Violet,color:black
    classDef JOIN stroke:DarkOrange,fill:Orange,color:black
    classDef RELATION stroke:Yellow,fill:Gold,color:black
    classDef AGGREGATE stroke:Brown,fill:Chocolate,color:black

    Union#1["Union"]:::UNION
    Project#11["Project: [name#153 AS name_a#176, name#167 AS name_b#177, null AS simple_id#204, null AS complex_id#262]"]:::PROJECT
    Join#111["Join: Inner, (id#166 = id2#159)"]:::JOIN
    Project#1111["Project: [name#153, id2#159]"]:::PROJECT
    Join#11111["Join: Inner, (id#152 = id1#158)"]:::JOIN
    Union#111111["Union"]:::UNION
    Project#1111111["Project: [id#152, name#153]"]:::PROJECT
    Filter#11111111["Filter: ((isnotnull(name#153) AND (RLIKE(name#153, simple) AND RLIKE(name#153, complex))) AND isnotnull(id#152))"]:::FILTER
    Relation#111111111["sample_table: [id#152,name#153,age#154] parquet"]:::RELATION
    Project#1111112["Project: [id#155, name#156]"]:::PROJECT
    Filter#11111121["Filter: ((isnotnull(name#156) AND (RLIKE(name#156, simple) AND RLIKE(name#156, complex))) AND isnotnull(id#155))"]:::FILTER
    Relation#111111211["sample_table_2: [id#155,name#156,birth_date#157] parquet"]:::RELATION
    Project#111112["Project: [id1#158, id2#159]"]:::PROJECT
    Filter#1111121["Filter: ((isnotnull(rel_type#160) AND (rel_type#160 = friend)) AND (isnotnull(id1#158) AND isnotnull(id2#159)))"]:::FILTER
    Relation#11111211["relation_table: [id1#158,id2#159,rel_type#160] parquet"]:::RELATION
    Union#1112["Union"]:::UNION
    Project#11121["Project: [id#166, name#167]"]:::PROJECT
    Filter#111211["Filter: isnotnull(id#166)"]:::FILTER
    Relation#1112111["sample_table: [id#166,name#167,age#168] parquet"]:::RELATION
    Project#11122["Project: [id#170, name#171]"]:::PROJECT
    Filter#111221["Filter: isnotnull(id#170)"]:::FILTER
    Relation#1112211["sample_table_2: [id#170,name#171,birth_date#172] parquet"]:::RELATION
    Project#12["Project: [name_a#202, name_b#203, id#178 AS simple_id#182, null AS complex_id#274]"]:::PROJECT
    Join#121["Join: LeftOuter, (name_a#202 = name#179)"]:::JOIN
    Project#1211["Project: [name#184 AS name_a#202, name#195 AS name_b#203]"]:::PROJECT
    Join#12111["Join: Inner, (id#194 = id2#192)"]:::JOIN
    Project#121111["Project: [name#184, id2#192]"]:::PROJECT
    Join#1211111["Join: Inner, (id#183 = id1#191)"]:::JOIN
    Union#12111111["Union"]:::UNION
    Project#121111111["Project: [id#183, name#184]"]:::PROJECT
    Filter#1211111111["Filter: ((isnotnull(name#184) AND (NOT RLIKE(name#184, simple) AND RLIKE(name#184, complex))) AND isnotnull(id#183))"]:::FILTER
    Relation#12111111111["sample_table: [id#183,name#184,age#185] parquet"]:::RELATION
    Project#121111112["Project: [id#187, name#188]"]:::PROJECT
    Filter#1211111121["Filter: ((isnotnull(name#188) AND (NOT RLIKE(name#188, simple) AND RLIKE(name#188, complex))) AND isnotnull(id#187))"]:::FILTER
    Relation#12111111211["sample_table_2: [id#187,name#188,birth_date#189] parquet"]:::RELATION
    Project#12111112["Project: [id1#191, id2#192]"]:::PROJECT
    Filter#121111121["Filter: ((isnotnull(rel_type#193) AND (rel_type#193 = friend)) AND (isnotnull(id1#191) AND isnotnull(id2#192)))"]:::FILTER
    Relation#1211111211["relation_table: [id1#191,id2#192,rel_type#193] parquet"]:::RELATION
    Union#121112["Union"]:::UNION
    Project#1211121["Project: [id#194, name#195]"]:::PROJECT
    Filter#12111211["Filter: isnotnull(id#194)"]:::FILTER
    Relation#121112111["sample_table: [id#194,name#195,age#196] parquet"]:::RELATION
    Project#1211122["Project: [id#198, name#199]"]:::PROJECT
    Filter#12111221["Filter: isnotnull(id#198)"]:::FILTER
    Relation#121112211["sample_table_2: [id#198,name#199,birth_date#200] parquet"]:::RELATION
    Project#1212["Project: [id#178, name#179]"]:::PROJECT
    Filter#12121["Filter: ((NOT RLIKE(name#179, simple) AND RLIKE(name#179, complex)) AND isnotnull(name#179))"]:::FILTER
    Relation#121211["sample_table: [id#178,name#179,age#180] parquet"]:::RELATION
    Project#13["Project: [name_a#234, name_b#235, simple_id#236, id#210 AS complex_id#214]"]:::PROJECT
    Join#131["Join: LeftOuter, (name_a#234 = name#211)"]:::JOIN
    Union#1311["Union"]:::UNION
    Project#13111["Project: [name#216 AS name_a#234, name#227 AS name_b#235, null AS simple_id#236]"]:::PROJECT
    Join#131111["Join: Inner, (id#226 = id2#224)"]:::JOIN
    Project#1311111["Project: [name#216, id2#224]"]:::PROJECT
    Join#13111111["Join: Inner, (id#215 = id1#223)"]:::JOIN
    Union#131111111["Union"]:::UNION
    Project#1311111111["Project: [id#215, name#216]"]:::PROJECT
    Filter#13111111111["Filter: ((isnotnull(name#216) AND (RLIKE(name#216, simple) AND NOT RLIKE(name#216, complex))) AND isnotnull(id#215))"]:::FILTER
    Relation#131111111111["sample_table: [id#215,name#216,age#217] parquet"]:::RELATION
    Project#1311111112["Project: [id#219, name#220]"]:::PROJECT
    Filter#13111111121["Filter: ((isnotnull(name#220) AND (RLIKE(name#220, simple) AND NOT RLIKE(name#220, complex))) AND isnotnull(id#219))"]:::FILTER
    Relation#131111111211["sample_table_2: [id#219,name#220,birth_date#221] parquet"]:::RELATION
    Project#131111112["Project: [id1#223, id2#224]"]:::PROJECT
    Filter#1311111121["Filter: ((isnotnull(rel_type#225) AND (rel_type#225 = friend)) AND (isnotnull(id1#223) AND isnotnull(id2#224)))"]:::FILTER
    Relation#13111111211["relation_table: [id1#223,id2#224,rel_type#225] parquet"]:::RELATION
    Union#1311112["Union"]:::UNION
    Project#13111121["Project: [id#226, name#227]"]:::PROJECT
    Filter#131111211["Filter: isnotnull(id#226)"]:::FILTER
    Relation#1311112111["sample_table: [id#226,name#227,age#228] parquet"]:::RELATION
    Project#13111122["Project: [id#230, name#231]"]:::PROJECT
    Filter#131111221["Filter: isnotnull(id#230)"]:::FILTER
    Relation#1311112211["sample_table_2: [id#230,name#231,birth_date#232] parquet"]:::RELATION
    Project#13112["Project: [name_a#256, name_b#257, id#258 AS simple_id#261]"]:::PROJECT
    Join#131121["Join: LeftOuter, (name_a#256 = name#259)"]:::JOIN
    Project#1311211["Project: [name#238 AS name_a#256, name#249 AS name_b#257]"]:::PROJECT
    Join#13112111["Join: Inner, (id#248 = id2#246)"]:::JOIN
    Project#131121111["Project: [name#238, id2#246]"]:::PROJECT
    Join#1311211111["Join: Inner, (id#237 = id1#245)"]:::JOIN
    Union#13112111111["Union"]:::UNION
    Project#131121111111["Project: [id#237, name#238]"]:::PROJECT
    Filter#1311211111111["Filter: ((isnotnull(name#238) AND (NOT RLIKE(name#238, simple) AND NOT RLIKE(name#238, complex))) AND isnotnull(id#237))"]:::FILTER
    Relation#13112111111111["sample_table: [id#237,name#238,age#239] parquet"]:::RELATION
    Project#131121111112["Project: [id#241, name#242]"]:::PROJECT
    Filter#1311211111121["Filter: ((isnotnull(name#242) AND (NOT RLIKE(name#242, simple) AND NOT RLIKE(name#242, complex))) AND isnotnull(id#241))"]:::FILTER
    Relation#13112111111211["sample_table_2: [id#241,name#242,birth_date#243] parquet"]:::RELATION
    Project#13112111112["Project: [id1#245, id2#246]"]:::PROJECT
    Filter#131121111121["Filter: ((isnotnull(rel_type#247) AND (rel_type#247 = friend)) AND (isnotnull(id1#245) AND isnotnull(id2#246)))"]:::FILTER
    Relation#1311211111211["relation_table: [id1#245,id2#246,rel_type#247] parquet"]:::RELATION
    Union#131121112["Union"]:::UNION
    Project#1311211121["Project: [id#248, name#249]"]:::PROJECT
    Filter#13112111211["Filter: isnotnull(id#248)"]:::FILTER
    Relation#131121112111["sample_table: [id#248,name#249,age#250] parquet"]:::RELATION
    Project#1311211122["Project: [id#252, name#253]"]:::PROJECT
    Filter#13112111221["Filter: isnotnull(id#252)"]:::FILTER
    Relation#131121112211["sample_table_2: [id#252,name#253,birth_date#254] parquet"]:::RELATION
    Project#1311212["Project: [id#258, name#259]"]:::PROJECT
    Filter#13112121["Filter: ((NOT RLIKE(name#259, simple) AND NOT RLIKE(name#259, complex)) AND isnotnull(name#259))"]:::FILTER
    Relation#131121211["sample_table: [id#258,name#259,age#260] parquet"]:::RELATION
    Project#1312["Project: [id#210, name#211]"]:::PROJECT
    Filter#13121["Filter: ((NOT RLIKE(name#211, complex) AND isnotnull(RLIKE(name#211, simple))) AND isnotnull(name#211))"]:::FILTER
    Relation#131211["sample_table: [id#210,name#211,age#212] parquet"]:::RELATION

    Union#1 --> Project#11
        Project#11 --> Join#111
            Join#111 --> Project#1111
                Project#1111 --> Join#11111
                    Join#11111 --> Union#111111
                        Union#111111 --> Project#1111111
                            Project#1111111 --> Filter#11111111
                                Filter#11111111 --> Relation#111111111
                        Union#111111 --> Project#1111112
                            Project#1111112 --> Filter#11111121
                                Filter#11111121 --> Relation#111111211
                    Join#11111 --> Project#111112
                        Project#111112 --> Filter#1111121
                            Filter#1111121 --> Relation#11111211
            Join#111 --> Union#1112
                Union#1112 --> Project#11121
                    Project#11121 --> Filter#111211
                        Filter#111211 --> Relation#1112111
                Union#1112 --> Project#11122
                    Project#11122 --> Filter#111221
                        Filter#111221 --> Relation#1112211
    Union#1 --> Project#12
        Project#12 --> Join#121
            Join#121 --> Project#1211
                Project#1211 --> Join#12111
                    Join#12111 --> Project#121111
                        Project#121111 --> Join#1211111
                            Join#1211111 --> Union#12111111
                                Union#12111111 --> Project#121111111
                                    Project#121111111 --> Filter#1211111111
                                        Filter#1211111111 --> Relation#12111111111
                                Union#12111111 --> Project#121111112
                                    Project#121111112 --> Filter#1211111121
                                        Filter#1211111121 --> Relation#12111111211
                            Join#1211111 --> Project#12111112
                                Project#12111112 --> Filter#121111121
                                    Filter#121111121 --> Relation#1211111211
                    Join#12111 --> Union#121112
                        Union#121112 --> Project#1211121
                            Project#1211121 --> Filter#12111211
                                Filter#12111211 --> Relation#121112111
                        Union#121112 --> Project#1211122
                            Project#1211122 --> Filter#12111221
                                Filter#12111221 --> Relation#121112211
            Join#121 --> Project#1212
                Project#1212 --> Filter#12121
                    Filter#12121 --> Relation#121211
    Union#1 --> Project#13
        Project#13 --> Join#131
            Join#131 --> Union#1311
                Union#1311 --> Project#13111
                    Project#13111 --> Join#131111
                        Join#131111 --> Project#1311111
                            Project#1311111 --> Join#13111111
                                Join#13111111 --> Union#131111111
                                    Union#131111111 --> Project#1311111111
                                        Project#1311111111 --> Filter#13111111111
                                            Filter#13111111111 --> Relation#131111111111
                                    Union#131111111 --> Project#1311111112
                                        Project#1311111112 --> Filter#13111111121
                                            Filter#13111111121 --> Relation#131111111211
                                Join#13111111 --> Project#131111112
                                    Project#131111112 --> Filter#1311111121
                                        Filter#1311111121 --> Relation#13111111211
                        Join#131111 --> Union#1311112
                            Union#1311112 --> Project#13111121
                                Project#13111121 --> Filter#131111211
                                    Filter#131111211 --> Relation#1311112111
                            Union#1311112 --> Project#13111122
                                Project#13111122 --> Filter#131111221
                                    Filter#131111221 --> Relation#1311112211
                Union#1311 --> Project#13112
                    Project#13112 --> Join#131121
                        Join#131121 --> Project#1311211
                            Project#1311211 --> Join#13112111
                                Join#13112111 --> Project#131121111
                                    Project#131121111 --> Join#1311211111
                                        Join#1311211111 --> Union#13112111111
                                            Union#13112111111 --> Project#131121111111
                                                Project#131121111111 --> Filter#1311211111111
                                                    Filter#1311211111111 --> Relation#13112111111111
                                            Union#13112111111 --> Project#131121111112
                                                Project#131121111112 --> Filter#1311211111121
                                                    Filter#1311211111121 --> Relation#13112111111211
                                        Join#1311211111 --> Project#13112111112
                                            Project#13112111112 --> Filter#131121111121
                                                Filter#131121111121 --> Relation#1311211111211
                                Join#13112111 --> Union#131121112
                                    Union#131121112 --> Project#1311211121
                                        Project#1311211121 --> Filter#13112111211
                                            Filter#13112111211 --> Relation#131121112111
                                    Union#131121112 --> Project#1311211122
                                        Project#1311211122 --> Filter#13112111221
                                            Filter#13112111221 --> Relation#131121112211
                        Join#131121 --> Project#1311212
                            Project#1311212 --> Filter#13112121
                                Filter#13112121 --> Relation#131121211
            Join#131 --> Project#1312
                Project#1312 --> Filter#13121
                    Filter#13121 --> Relation#131211
