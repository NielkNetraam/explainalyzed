flowchart TD
    classDef PROJECT stroke:Blue,fill:LightBlue,color:black
    classDef FILTER stroke:Green,fill:LightGreen,color:black
    classDef UNION stroke:Purple,fill:Violet,color:black
    classDef JOIN stroke:DarkOrange,fill:Orange,color:black
    classDef RELATION stroke:Yellow,fill:Gold,color:black
    classDef AGGREGATE stroke:Brown,fill:Chocolate,color:black

    Aggregate#1["Aggregate: [id#133], [id#133, count(1) AS count#141L, sum(CASE WHEN (sign#138 = DEBIT) THEN amount#137 ELSE -amount#137 END) AS total_amount#142]"]:::AGGREGATE
    Project#11["Project: [id#133, amount#137, sign#138]"]:::PROJECT
    Join#111["Join: LeftOuter, (id#133 = id#136)"]:::JOIN
    Project#1111["Project: [id#133]"]:::PROJECT
    Relation#11111["sample_table: [id#133,name#134,age#135] parquet"]:::RELATION
    Filter#1112["Filter: isnotnull(id#136)"]:::FILTER
    Relation#11121["transaction_table: [id#136,amount#137,sign#138] parquet"]:::RELATION

    Aggregate#1 --> Project#11
        Project#11 --> Join#111
            Join#111 --> Project#1111
                Project#1111 --> Relation#11111
            Join#111 --> Filter#1112
                Filter#1112 --> Relation#11121
