flowchart LR
    classDef SOURCE stroke:Blue,fill:LightBlue,color:black
    classDef TARGET stroke:Green,fill:LightGreen,color:black
    classDef INTERMEDIATE stroke:DarkOrange,fill:Orange,color:black
    classDef INTERNAL stroke:Purple,fill:Violet,color:black
    classDef FIELD stroke:Orange,fill:Gold,color:black

    sample_table:::SOURCE
    transaction_table:::SOURCE
    target:::TARGET

    subgraph sample_table
        sample_table.id[id]:::FIELD
    end

    subgraph transaction_table
        transaction_table.amount[amount]:::FIELD
        transaction_table.id[id]:::FIELD
        transaction_table.sign[sign]:::FIELD
    end

    subgraph target
        target.count[count]:::FIELD
        target.id[id]:::FIELD
        target.total_amount[total_amount]:::FIELD
    end

    sample_table.id -- GROUP_BY --> target.count
    sample_table.id -- COLUMN,GROUP_BY,JOIN --> target.id
    sample_table.id -- GROUP_BY,JOIN --> target.total_amount
    transaction_table.amount -- COLUMN --> target.total_amount
    transaction_table.id -- GROUP_BY --> target.count
    transaction_table.id -- GROUP_BY,JOIN --> target.id
    transaction_table.id -- FILTER,GROUP_BY,JOIN --> target.total_amount
    transaction_table.sign -- COLUMN --> target.total_amount
